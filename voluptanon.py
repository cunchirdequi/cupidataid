def add_with_residual(x, residual):
    return x + residual, residual
